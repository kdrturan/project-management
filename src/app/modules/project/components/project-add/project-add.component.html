<div class="main-content">
  <div class="container">
    <div class="header">
      <h1>Yeni Proje OluÅŸtur</h1>
      <p>Projenizi oluÅŸturmak iÃ§in formu doldurun</p>
    </div>

    <form [formGroup]="projectForm" (ngSubmit)="onSubmit()">
      <div class="content">
        <div class="form-section">
          <h2>Proje DetaylarÄ±</h2>
          
          <div class="form-group">
            <label>Proje AdÄ± <span class="required">*</span></label>
            <input type="text" formControlName="name" class="form-control" placeholder="Projenizin adÄ±nÄ± girin">
          </div>

          <div class="form-group">
            <label>Proje AÃ§Ä±klamasÄ±</label>
            <textarea formControlName="description" class="form-control" rows="4" placeholder="Projeniz hakkÄ±nda detaylÄ± aÃ§Ä±klama yazÄ±n..."></textarea>
          </div>

          <div class="form-group">
            <label>Proje DosyalarÄ±</label>
            <div class="file-upload-area" (click)="fileInput.click()">
              <div class="upload-icon">ðŸ“Ž</div>
              <div class="upload-text">
                <strong>DosyalarÄ± buraya sÃ¼rÃ¼kleyin</strong><br>
                <span>veya tÄ±klayarak seÃ§in</span>
              </div>
              <div class="upload-info">PDF, DOC, XLS, PNG, JPG (Max: 10MB)</div>
            </div>
            <input #fileInput type="file" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg" 
                   style="display: none;" (change)="onFileSelected($event)">
            
            <div class="file-list" *ngIf="uploadedFiles.length > 0">
              <div class="file-item" *ngFor="let file of uploadedFiles; let i = index">
                <div class="file-info">
                  <span class="file-icon">{{ getFileIcon(file.name) }}</span>
                  <div class="file-details">
                    <div class="file-name">{{ file.name }}</div>
                    <div class="file-size">{{ formatFileSize(file.size) }}</div>
                  </div>
                </div>
                <button type="button" class="file-remove" (click)="removeFile(i)">Ã—</button>
              </div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>BaÅŸlangÄ±Ã§ Tarihi</label>
              <input type="date" formControlName="plannedStartDate" class="form-control">
            </div>
            <div class="form-group">
              <label>BitiÅŸ Tarihi</label>
              <input type="date" formControlName="plannedEndDate" class="form-control">
            </div>
          </div>

          <div class="form-group">
            <label>Ã–ncelik Seviyesi</label>
            <select formControlName="priority" class="form-control">
              <option *ngFor="let priority of priorities" [value]="priority.value">
                {{ priority.label }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label>BÃ¼tÃ§e (â‚º)</label>
            <input type="number" formControlName="budget" class="form-control" placeholder="0.00">
          </div>

          <!-- Work Packages Expander Section -->
          <div class="work-packages-section">
            <div class="expander-header" (click)="toggleWorkPackageSection()">
              <h3>
                <span class="expander-icon" [class.expanded]="isWorkPackageExpanded">â–¶</span>
                Ä°ÅŸ Paketleri
                <span class="work-package-count" *ngIf="getWorkPackagePreviewCount() > 0">
                  ({{ getWorkPackagePreviewCount() }} paket)
                </span>
              </h3>
              <p class="expander-desc">Projeye ait iÅŸ paketlerini tanÄ±mlayÄ±n</p>
            </div>

            <div class="expander-content" [class.expanded]="isWorkPackageExpanded">
              <div class="work-packages-container" formArrayName="workPackages">
                <div class="work-packages-header">
                  <button type="button" class="btn-add-workpackage" (click)="addWorkPackage()">
                    <span>+</span> Yeni Ä°ÅŸ Paketi Ekle
                  </button>
                </div>

                <div class="work-package-list" *ngIf="workPackages.length > 0">
                  <div class="work-package-item" *ngFor="let wp of workPackages.controls; let i = index" [formGroupName]="i">
                    <div class="work-package-header">
                      <h4>Ä°ÅŸ Paketi {{ i + 1 }}</h4>
                      <button type="button" class="btn-remove-workpackage" (click)="removeWorkPackage(i)">Ã—</button>
                    </div>

                    <div class="work-package-form">
                      <div class="form-group">
                        <label>Ä°ÅŸ Paketi AdÄ± <span class="required">*</span></label>
                        <input type="text" formControlName="name" class="form-control" placeholder="Ä°ÅŸ paketi adÄ±nÄ± girin">
                      </div>

                      <div class="form-group">
                        <label>AÃ§Ä±klama</label>
                        <textarea formControlName="description" class="form-control" rows="2" placeholder="Ä°ÅŸ paketi aÃ§Ä±klamasÄ±..."></textarea>
                      </div>

                      <div class="form-row">
                        <div class="form-group">
                          <label>Durum</label>
                          <select formControlName="status" class="form-control">
                            <option *ngFor="let status of workPackageStatuses" [value]="status.value">
                              {{ status.label }}
                            </option>
                          </select>
                        </div>
                        <div class="form-group">
                          <label>Departman <span class="required">*</span></label>
                          <select formControlName="department" 
                                  class="form-control" 
                                  (change)="onDepartmentChange(i, $any($event.target).value)">
                            <option value="">Departman SeÃ§iniz</option>
                            <option *ngFor="let department of departments" [value]="department.id">
                              {{ department.name }}
                            </option>
                          </select>
                        </div>
                      </div>

                      <div class="form-row">
                        <div class="form-group">
                          <label>BaÅŸlangÄ±Ã§ Tarihi</label>
                          <input type="date" formControlName="plannedStartDate" class="form-control">
                        </div>
                        <div class="form-group">
                          <label>BitiÅŸ Tarihi</label>
                          <input type="date" formControlName="plannedEndDate" class="form-control">
                        </div>
                      </div>

                      <div class="form-group">
                        <label>Teknik YÃ¶netici ID</label>
                        <input type="number" formControlName="technicalManagerId" class="form-control" placeholder="Teknik yÃ¶netici ID">
                      </div>
                    </div>
                  </div>
                </div>

                <div class="no-work-packages" *ngIf="workPackages.length === 0">
                  <p>HenÃ¼z iÅŸ paketi eklenmedi. YukarÄ±daki butonu kullanarak yeni iÅŸ paketi ekleyebilirsiniz.</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="preview-section">
          <div class="preview-card">
            <h3>ðŸ“‹ Proje Ã–zeti</h3>
            
            <div class="preview-item">
              <span class="preview-label">Proje AdÄ±:</span>
              <span class="preview-value">{{ projectForm.get('name')?.value || 'Proje AdÄ± Girilmedi' }}</span>
            </div>
            
            <div class="preview-item">
              <span class="preview-label">AÃ§Ä±klama:</span>
              <span class="preview-value description">
                {{ (projectForm.get('description')?.value || 'AÃ§Ä±klama girilmedi').substring(0, 50) + '...' }}
              </span>
            </div>
            
            <div class="preview-item">
              <span class="preview-label">Dosya SayÄ±sÄ±:</span>
              <span class="preview-value">{{ uploadedFiles.length }} dosya</span>
            </div>
            
            <div class="preview-item">
              <span class="preview-label">BaÅŸlangÄ±Ã§:</span>
              <span class="preview-value">{{ formatDate(projectForm.get('plannedStartDate')?.value) }}</span>
            </div>
            
            <div class="preview-item">
              <span class="preview-label">BitiÅŸ:</span>
              <span class="preview-value">{{ formatDate(projectForm.get('plannedEndDate')?.value) }}</span>
            </div>
            
            <div class="preview-item">
              <span class="preview-label">SÃ¼re:</span>
              <span class="preview-value">{{ calculateDuration() }}</span>
            </div>
            
            <div class="preview-item">
              <span class="preview-label">BÃ¼tÃ§e:</span>
              <span class="preview-value">{{ formatCurrency(projectForm.get('budget')?.value) }}</span>
            </div>

            <div class="preview-item" *ngIf="getWorkPackagePreviewCount() > 0">
              <span class="preview-label">Ä°ÅŸ Paketleri:</span>
              <span class="preview-value">{{ getWorkPackagePreviewCount() }} paket</span>
            </div>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button type="submit" class="btn btn-primary">
          <span style="margin-right: 8px;">âœ“</span>
          Projeyi OluÅŸtur
        </button>
      </div>
    </form>
  </div>
</div>